<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ProgressBar?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.FlowPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane fx:id="rootPane" 
            stylesheets="@../css/orangtuadashboard.css" 
            xmlns="http://javafx.com/javafx/17" 
            xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="Proyek.Controller.OrangTuaDashboardController">

    <!-- SIDEBAR -->
    <left>
        <VBox fx:id="sidebar" styleClass="sidebar" spacing="0" prefWidth="220">
            <!-- Logo/Title Section -->
            <VBox styleClass="sidebar-header" alignment="CENTER" spacing="5">
                <padding>
                    <Insets top="20" right="15" bottom="20" left="15" />
                </padding>
                <Label text="DOMPETKU" styleClass="sidebar-title"/>
                <Label text="Parent Portal" styleClass="sidebar-subtitle"/>
            </VBox>
            
            <!-- Navigation Menu -->
            <VBox styleClass="nav-section" spacing="5" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets top="20" right="10" bottom="10" left="10" />
                </padding>
                
                <Label text="MENU" styleClass="nav-section-title"/>
                
                <Button fx:id="btnDashboard" text="Dashboard" styleClass="nav-button" maxWidth="Infinity" alignment="CENTER_LEFT"/>
                
                <Button fx:id="btnTransaksi" text="Transaksi" styleClass="nav-button" maxWidth="Infinity" alignment="CENTER_LEFT"/>
                
                <Button fx:id="btnBudgeting" text="Budgeting" styleClass="nav-button" maxWidth="Infinity" alignment="CENTER_LEFT"/>
                
                <Button fx:id="btnGoals" text="Goals" styleClass="nav-button" maxWidth="Infinity" alignment="CENTER_LEFT"/>
            </VBox>
            
            <!-- Logout Button -->
            <VBox alignment="CENTER" spacing="10">
                <padding>
                    <Insets top="5" right="15" bottom="20" left="15" />
                </padding>
                <Button fx:id="btnLogout" text="Logout" styleClass="logout-button" maxWidth="Infinity"/>
            </VBox>
        </VBox>
    </left>

    <!-- MAIN CONTENT -->
    <center>
        <StackPane fx:id="mainContent" styleClass="main-content">
            <!-- Background -->
            <ImageView fx:id="bgImage" preserveRatio="false" fitWidth="900" fitHeight="700"/>
            
            
            <AnchorPane styleClass="content-overlay"/>
            
            <ScrollPane fitToWidth="true" styleClass="content-scroll">
                <VBox fx:id="contentArea" spacing="20" styleClass="content-container">
                    <padding>
                        <Insets top="30" right="30" bottom="30" left="30" />
                    </padding>
                    
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label fx:id="lblPageTitle" text="Dashboard Orang Tua" styleClass="page-title"/>
                        
                        <Pane HBox.hgrow="ALWAYS"/>
                        
                        <Button fx:id="btnNotifHeader" styleClass="notifButton" onAction="#showNotifications">
                            <graphic>
                                <ImageView fitHeight="24" fitWidth="24" preserveRatio="true">
                                    <Image url="@../image/notification.png"/>
                                </ImageView>
                            </graphic>
                        </Button>
                    </HBox>
                    
                    <VBox fx:id="connectPanel" styleClass="connect-panel" alignment="CENTER" spacing="20" visible="true">
                        <VBox.margin>
                            <Insets top="50" bottom="50" />
                        </VBox.margin>
                        <padding>
                            <Insets top="40" right="40" bottom="40" left="40" />
                        </padding>
                        <Label text="Hubungkan Akun Anak" styleClass="connect-title"/>
                        <Label text="Masukkan kode akses untuk terhubung dengan anak Anda" styleClass="connect-subtitle"/>
                        <TextField fx:id="childCodeField" promptText="Masukkan Kode Anak" styleClass="code-input" maxWidth="350"/>
                        <Button fx:id="connectButton" text="CONNECT" styleClass="connect-button" onAction="#handleConnect"/>
                        <Label fx:id="statusLabel" styleClass="error-label" text="" wrapText="true"/>
                    </VBox>
                    
                    <VBox fx:id="dashboardContent" spacing="25" visible="false" managed="false">
                        
                        <HBox fx:id="summaryCards" spacing="20" alignment="CENTER">
                            <VBox styleClass="summary-card card-balance" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="Total Saldo" styleClass="card-label"/>
                                <Label fx:id="lblTotalSaldo" text="Rp 0" styleClass="card-value"/>
                            </VBox>
                            <VBox styleClass="summary-card card-expense" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="Pengeluaran Bulan Ini" styleClass="card-label"/>
                                <Label fx:id="lblMonthlyExpense" text="Rp 0" styleClass="card-value"/>
                            </VBox>
                            <VBox styleClass="summary-card card-income" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="Pemasukan Bulan Ini" styleClass="card-label"/>
                                <Label fx:id="lblMonthlyIncome" text="Rp 0" styleClass="card-value"/>
                            </VBox>
                            <VBox styleClass="summary-card card-count" alignment="CENTER" spacing="5" HBox.hgrow="ALWAYS">
                                <Label text="Jumlah Transaksi" styleClass="card-label"/>
                                <Label fx:id="lblTransactionCount" text="0" styleClass="card-value"/>
                            </VBox>
                        </HBox>
                        
                        <HBox spacing="20">
                            <VBox styleClass="chart-card" HBox.hgrow="ALWAYS">
                                <Label text="Pengeluaran per Kategori" styleClass="section-title"/>
                                <PieChart fx:id="pieExpenseByCategory" prefHeight="300" legendVisible="true"/>
                            </VBox>
                            
                            <VBox fx:id="alertsBox" styleClass="alerts-card" HBox.hgrow="ALWAYS" spacing="10">
                                <Label text="Transaksi Besar Terbaru" styleClass="section-title"/>
                                <VBox fx:id="largeTransactionsList" spacing="8">
                                    <Label text="Tidak ada transaksi besar" styleClass="empty-text"/>
                                </VBox>
                            </VBox>
                        </HBox>
                        
                        <VBox styleClass="table-card" spacing="10">
                            <Label text="Riwayat Transaksi Terbaru" styleClass="section-title"/>
                            <TableView fx:id="transactionTable" prefHeight="400" styleClass="data-table">
                                <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                                <columns>
                                    <TableColumn fx:id="colTanggal" text="Tanggal" minWidth="100"/>
                                    <TableColumn fx:id="colKategori" text="Kategori" minWidth="100"/>
                                    <TableColumn fx:id="colDompet" text="Dompet" minWidth="100"/>
                                    <TableColumn fx:id="colCatatan" text="Deskripsi" minWidth="150"/>
                                    <TableColumn fx:id="colNominal" text="Nominal" minWidth="120"/>
                                    <TableColumn fx:id="colJenis" text="Jenis" minWidth="90"/>
                                </columns>
                                <placeholder>
                                    <Label text="Belum ada transaksi"/>
                                </placeholder>
                            </TableView>
                        </VBox>
                    </VBox>
                    
                    <VBox fx:id="budgetingContent" spacing="20" visible="false" managed="false">
                        <HBox alignment="CENTER_LEFT" spacing="20">
                            <Label text="Budget Limits" styleClass="section-title"/>
                            <Button fx:id="btnAddBudget" text="+ Tambah Budget" styleClass="add-button"/>
                        </HBox>
                        
                        <FlowPane fx:id="budgetCardsPane" hgap="15" vgap="15">
                            <Label text="Belum ada budget yang diatur" styleClass="empty-text"/>
                        </FlowPane>
                    </VBox>
                    
                    <VBox fx:id="goalsContent" spacing="20" visible="false" managed="false">
                        <Label text="Target Tabungan Anak" styleClass="section-title"/>
                        
                        <FlowPane fx:id="goalsCardsPane" hgap="15" vgap="15">
                            <Label text="Belum ada target tabungan" styleClass="empty-text"/>
                        </FlowPane>
                    </VBox>
                    
                    <VBox fx:id="transactionHistoryContent" spacing="20" visible="false" managed="false">
                        <Label text="Riwayat Transaksi Lengkap" styleClass="section-title"/>
                        
                        <TableView fx:id="fullTransactionTable" prefHeight="500" styleClass="data-table">
                            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                            <columns>
                                <TableColumn fx:id="colFullTanggal" text="Tanggal" minWidth="110"/>
                                <TableColumn fx:id="colFullKategori" text="Kategori" minWidth="100"/>
                                <TableColumn fx:id="colFullDompet" text="Dompet" minWidth="100"/>
                                <TableColumn fx:id="colFullCatatan" text="Deskripsi" minWidth="150"/>
                                <TableColumn fx:id="colFullNominal" text="Nominal" minWidth="120"/>
                                <TableColumn fx:id="colFullJenis" text="Jenis" minWidth="90"/>
                            </columns>
                            <placeholder>
                                <Label text="Belum ada transaksi"/>
                            </placeholder>
                        </TableView>
                    </VBox>
                    
                    <VBox fx:id="notificationContent" spacing="20" visible="false" managed="false">
                        <HBox alignment="CENTER_LEFT" spacing="20">
                            <Label text="Notifikasi Transaksi Besar" styleClass="section-title"/>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Threshold: Rp" styleClass="threshold-label"/>
                                <TextField fx:id="thresholdField" text="500000" prefWidth="120" styleClass="threshold-input"/>
                                <Button fx:id="btnApplyThreshold" text="Terapkan" styleClass="apply-button"/>
                            </HBox>
                        </HBox>
                        
                        <VBox fx:id="notificationList" spacing="10">
                            <Label text="Tidak ada transaksi besar" styleClass="empty-text"/>
                        </VBox>
                    </VBox>
                    
                </VBox>
            </ScrollPane>
        </StackPane>
    </center>

</BorderPane>